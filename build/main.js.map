{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["/*\n * Created with @iobroker/create-adapter v3.1.2\n *\n * This code is adapted from https://github.com/ioBroker/ioBroker.influxdb\n * Mostly:\n *  - Instrumentation logic\n *  - UI layout stuff\n *  - Persistence, custom state logic\n *\n * ########################################\n * Copyright Notice of ioBroker.influxdb\n * ========================================\n *\n * The MIT License (MIT)\n * Copyright (c) 2015-2025 bluefox, apollon77\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n * ########################################\n */\n\nimport type { Gauge, Meter as IMeter } from '@opentelemetry/api';\nimport type { PushMetricExporter, ResourceMetrics } from '@opentelemetry/sdk-metrics';\nimport { MeterProvider, PeriodicExportingMetricReader } from '@opentelemetry/sdk-metrics';\nimport type { OTLPMetricExporterOptions } from '@opentelemetry/exporter-metrics-otlp-http';\nimport { OTLPMetricExporter as OTLPHttpExporter } from '@opentelemetry/exporter-metrics-otlp-http';\nimport { OTLPMetricExporter as OTLPGrpcExporter } from '@opentelemetry/exporter-metrics-otlp-grpc';\nimport type { Resource } from '@opentelemetry/resources';\nimport { resourceFromAttributes, emptyResource } from '@opentelemetry/resources';\n\nimport * as utils from '@iobroker/adapter-core';\nimport type { OtlpAdapterConfig, OtlpCustomConfig, OtlpCustomConfigTyped } from './types';\n\nfunction isNullOrUndefined(obj?: any): obj is null {\n    return obj === undefined || obj === null;\n}\n\nfunction parseNumberWithNull(value: any): number | null {\n    if (typeof value === 'number') {\n        return value;\n    }\n    if (typeof value === 'string') {\n        const v = parseFloat(value);\n        return isNaN(v) ? null : v;\n    }\n    if (typeof value === 'boolean') {\n        return value ? 1 : 0;\n    }\n    return null;\n}\n\nfunction iobTable2Record(attributesFromConfig: { key: string; value: string }[] | undefined): Record<string, string> {\n    if (!attributesFromConfig) {\n        return {};\n    }\n\n    return attributesFromConfig.reduce((prev, tuple) => ({ ...prev, [tuple.key]: tuple.value }), {});\n}\n\ninterface SavedOtlpCustomConfig extends OtlpCustomConfigTyped {\n    config: string;\n    realId: string;\n    state: ioBroker.State | null | undefined;\n    skipped: ioBroker.State | null | undefined;\n    lastLogTime?: number;\n}\n\nclass Otlp extends utils.Adapter {\n    declare config: OtlpAdapterConfig;\n\n    private _subscribeAll = false;\n\n    private _resource: Resource | null = null;\n    private _meterProvider: MeterProvider | null = null;\n    private _meter: IMeter | null = null;\n\n    private _connected: boolean = false;\n\n    // Mapping from AliasID to ioBroker ID\n    private readonly _trackedDataPoints: {\n        [ioBrokerId: string]: SavedOtlpCustomConfig;\n    } = {};\n\n    private readonly _instrumentLookup: Record<string, Gauge> = {};\n\n    public constructor(options: Partial<utils.AdapterOptions> = {}) {\n        super({\n            ...options,\n            name: 'otlp',\n        });\n        this.on('ready', this.onReady.bind(this));\n        this.on('stateChange', this.onStateChange.bind(this));\n        this.on('objectChange', this.onObjectChange.bind(this));\n        this.on('unload', this.onUnload.bind(this));\n    }\n\n    private _protocol: string = '';\n    private _otlProtocol: string = '';\n    private _host: string = '';\n    private _port: string | number = '';\n\n    private async onReady(): Promise<void> {\n        this.setConnected(false);\n\n        const { protocol, otlProtocol, host, port } = this.config;\n\n        if (\n            isNullOrUndefined(protocol) ||\n            isNullOrUndefined(otlProtocol) ||\n            isNullOrUndefined(host) ||\n            isNullOrUndefined(port)\n        ) {\n            this.log.error(\n                'At least one required property was not set. Cannot start. Please adjust the configuration.',\n            );\n            await this.stop?.call({\n                exitCode: 1,\n                reason: 'Incomplete configuration. Please adjust the configuration.',\n            });\n            return;\n        }\n        this._protocol = protocol;\n        this._otlProtocol = otlProtocol;\n        this._host = host;\n        this._port = port;\n\n        const { resourceAttributes } = this.config;\n\n        const connectionValid = await this.testConnectionAsync();\n        this.setConnected(connectionValid);\n\n        if (!connectionValid) {\n            this.log.info('Provided connection info is invalid. Please adjust the configuration.');\n            await this.stop?.call({ exitCode: 1, reason: 'Invalid configuration. Cannot connect to OTLP gateway.' });\n            return;\n        }\n\n        const { exporter: metricExporter } = this.createEndpointAndExporter();\n\n        if (isNullOrUndefined(metricExporter)) {\n            return;\n        }\n\n        this._resource =\n            !!resourceAttributes && Object.keys(resourceAttributes).length > 0\n                ? resourceFromAttributes(iobTable2Record(resourceAttributes))\n                : emptyResource();\n\n        await this.loadCustomEntitiesAsync();\n\n        this.createMeter(metricExporter);\n        this.createMetricInstruments();\n\n        this.subscribeToStates();\n        this.subscribeForeignObjects('*');\n    }\n\n    private createMeter(metricExporter: PushMetricExporter): void {\n        this._meterProvider = new MeterProvider({\n            readers: [\n                new PeriodicExportingMetricReader({\n                    exporter: metricExporter,\n                    exportIntervalMillis: 1000,\n                }),\n            ],\n            resource: this._resource ?? emptyResource(),\n        });\n\n        const { meterName } = this.config;\n\n        this._meter = this._meterProvider.getMeter(meterName ?? this.namespace, undefined, {});\n    }\n\n    private testConnectionAsync(): Promise<boolean> {\n        const { endpoint: otlpEndpoint, exporter: metricExporter } = this.createEndpointAndExporter();\n\n        if (!otlpEndpoint || !metricExporter) {\n            this.log.error('Could not create metric exporter. Cannot continue. Stopping.');\n            return Promise.resolve(false);\n        }\n\n        this.log.info(`Connecting to OTLP endpoint: ${otlpEndpoint}`);\n\n        const testPayload: ResourceMetrics = {\n            resource: emptyResource(),\n            scopeMetrics: [],\n        };\n\n        return new Promise((resolve, _) => {\n            metricExporter.export(testPayload, async result => {\n                await metricExporter.shutdown();\n\n                if (result.error === undefined) {\n                    resolve(true);\n                    return;\n                }\n\n                this.log.warn(\n                    `An error occurred trying to connect to the provided open telemetry gateway: ${result.error.message}`,\n                );\n\n                if (result.error.stack !== undefined && result.error.stack.length > 0) {\n                    this.log.debug(result.error.stack);\n                }\n\n                resolve(false);\n            });\n        });\n    }\n\n    private subscribeToStates(): void {\n        // If we have less than 20 data points, subscribe individually, else subscribe to all\n        if (Object.keys(this._trackedDataPoints).length < 20) {\n            this.log.info(`subscribing to ${Object.keys(this._trackedDataPoints).length} data points`);\n            for (const _id in this._trackedDataPoints) {\n                if (Object.prototype.hasOwnProperty.call(this._trackedDataPoints, _id)) {\n                    this.subscribeForeignStates(this._trackedDataPoints[_id].realId);\n                }\n            }\n        } else {\n            this.log.debug(\n                `subscribing to all data points as we have ${Object.keys(this._trackedDataPoints).length} data points to log`,\n            );\n            this._subscribeAll = true;\n            this.subscribeForeignStates('*');\n        }\n    }\n\n    private async loadCustomEntitiesAsync(): Promise<void> {\n        const doc = await this.getObjectViewAsync('system', 'custom', {});\n\n        if (!doc || !doc.rows || doc.rows.length == 0) {\n            return;\n        }\n\n        const filteredRows = doc.rows.filter(row => !!row.value).filter(row => row.value[this.namespace]?.enabled);\n\n        for (const row of filteredRows) {\n            const item: {\n                id: string;\n                value: {\n                    [key: `${string}.${number}`]: OtlpCustomConfigTyped;\n                };\n            } = row;\n\n            const id = item.id;\n            const realId = id;\n\n            this._trackedDataPoints[id] = item.value[this.namespace] as SavedOtlpCustomConfig;\n\n            this._trackedDataPoints[id].config = JSON.stringify(item.value[this.namespace]);\n            this.log.debug(`Enabled logging of ${id}, Alias=${id !== realId} points now activated`);\n\n            this._trackedDataPoints[id].realId = realId;\n        }\n    }\n\n    private createMetricInstruments(): void {\n        this.log.info(`Creating instruments for ${Object.keys(this._trackedDataPoints).length} data points.`);\n\n        for (const trackedDataPointKey of Object.keys(this._trackedDataPoints)) {\n            this.createInstrumentForDataPointKey(trackedDataPointKey);\n        }\n    }\n\n    private getInstrumentIdentifier(dataPoint: SavedOtlpCustomConfig): string {\n        const { aliasId, realId } = dataPoint;\n        return isNullOrUndefined(aliasId) || aliasId.trim() === '' ? realId : aliasId;\n    }\n\n    private createInstrumentForDataPointKey(trackedDataPointKey: string): void {\n        if (!Object.prototype.hasOwnProperty.call(this._trackedDataPoints, trackedDataPointKey)) {\n            this.log.warn(\n                `Expected instrument '${trackedDataPointKey}' to be present in data points, but it was not. Skipping.`,\n            );\n            return;\n        }\n\n        const trackedDataPoint = this._trackedDataPoints[trackedDataPointKey];\n        const instrumentIdentifier = this.getInstrumentIdentifier(trackedDataPoint);\n\n        if (isNullOrUndefined(this._meter)) {\n            this.log.error('No meter instance was created. This should never happen.');\n            return;\n        }\n\n        this.log.debug(`Creating gauge with name: '${instrumentIdentifier}' (key=${trackedDataPointKey})`);\n        this._instrumentLookup[trackedDataPointKey] = this._meter.createGauge(instrumentIdentifier);\n    }\n\n    private async onUnload(callback: () => void): Promise<void> {\n        try {\n            this.log.info('Shutting down open telemetry SDK.');\n\n            if (!isNullOrUndefined(this._meterProvider)) {\n                await this._meterProvider.forceFlush();\n                await this._meterProvider.shutdown();\n            }\n\n            this.setConnected(false);\n        } finally {\n            callback();\n        }\n    }\n\n    private isTrackedDataPoint(object: unknown): object is OtlpCustomConfig {\n        if (object === null || object === undefined) {\n            return false;\n        }\n\n        return (\n            Object.prototype.hasOwnProperty.call(object, 'aliasId') &&\n            Object.prototype.hasOwnProperty.call(object, 'enabled')\n        );\n    }\n\n    private async onObjectChange(id: string, obj: ioBroker.Object | null | undefined): Promise<void> {\n        if (isNullOrUndefined(obj?.common?.custom?.[this.namespace])) {\n            return;\n        }\n\n        const customConfig = obj.common.custom[this.namespace];\n\n        if (!this.isTrackedDataPoint(customConfig)) {\n            return;\n        }\n\n        customConfig.enabled ? this.addTrackedDataPoint(id, customConfig) : this.removeTrackedDataPoint(id);\n\n        const startMs = performance.now();\n        await this._meterProvider?.forceFlush();\n        await this._meterProvider?.shutdown();\n\n        const { exporter: nextExporter } = this.createEndpointAndExporter();\n\n        if (isNullOrUndefined(nextExporter)) {\n            return;\n        }\n\n        // There is no way to destroy an existing meter (which is valid, because that's usually not how otel works).\n        // Instead, we need to stop the entire SDK and recreate the meters.\n        // This is quite efficient, so it's not an issue.\n\n        this.createMeter(nextExporter);\n        this.createMetricInstruments();\n\n        const duration = performance.now() - startMs;\n        this.log.debug(`Recreated SDK and meters in ${duration}ms.`);\n\n        if (!customConfig.enabled) {\n            return;\n        }\n\n        await this.writeInitialValueAsync(id);\n    }\n\n    private addTrackedDataPoint(id: string, customConfig: OtlpCustomConfig): void {\n        // if not yet subscribed\n        if (!this._trackedDataPoints[id] && !this._subscribeAll) {\n            if (Object.keys(this._trackedDataPoints).length >= 19) {\n                // unsubscribe all subscriptions and subscribe to all\n                for (const _id in this._trackedDataPoints) {\n                    this.unsubscribeForeignStates(this._trackedDataPoints[_id].realId);\n                }\n                this._subscribeAll = true;\n                this.subscribeForeignStates('*');\n            } else {\n                this.subscribeForeignStates(id);\n            }\n        }\n\n        const customSettings: OtlpCustomConfig = customConfig;\n\n        const state = this._trackedDataPoints[id] ? this._trackedDataPoints[id].state : null;\n        const skipped = this._trackedDataPoints[id] ? this._trackedDataPoints[id].skipped : null;\n\n        this._trackedDataPoints[id] = customSettings as SavedOtlpCustomConfig;\n        this._trackedDataPoints[id].config = JSON.stringify(customSettings);\n        this._trackedDataPoints[id].realId = id;\n        this._trackedDataPoints[id].state = state;\n        this._trackedDataPoints[id].skipped = skipped;\n\n        this.log.info(`enabled logging of ${id}, Alias=${!!customSettings.aliasId}`);\n    }\n\n    private removeTrackedDataPoint(id: string): void {\n        if (!this._trackedDataPoints[id]) {\n            return;\n        }\n\n        delete this._trackedDataPoints[id];\n        this.log.info(`disabled logging of ${id}`);\n\n        if (!this._subscribeAll) {\n            this.unsubscribeForeignStates(id);\n        }\n    }\n\n    async writeInitialValueAsync(id: string): Promise<void> {\n        const state = await this.getForeignStateAsync(id);\n\n        if (!state || !this._trackedDataPoints[id]) {\n            return;\n        }\n\n        state.from = `system.adapter.${this.namespace}`;\n        this._trackedDataPoints[id].state = state;\n\n        this.recordStateByIobId(id, state);\n    }\n\n    private onStateChange(id: string, state: ioBroker.State | null | undefined): void {\n        if (!state) {\n            return;\n        }\n\n        if (isNullOrUndefined(this._trackedDataPoints[id])) {\n            return;\n        }\n\n        this.recordStateByIobId(id, state);\n    }\n\n    createEndpointAndExporter(): { endpoint: string | null; exporter: PushMetricExporter | null } {\n        let otlpEndpoint: string | null = null;\n        let metricExporter: PushMetricExporter | null = null;\n\n        const { headers } = this.config;\n        const headerRecord = iobTable2Record(headers);\n\n        this.log.debug(`There are ${Object.keys(headers).length} header kvps to append.`);\n\n        if (this._otlProtocol === 'http') {\n            otlpEndpoint = `${this._protocol}://${this._host}:${this._port}/v1/metrics`;\n\n            const collectorOptions: OTLPMetricExporterOptions = {\n                url: otlpEndpoint,\n                headers: headerRecord,\n            };\n            metricExporter = new OTLPHttpExporter(collectorOptions);\n        }\n\n        if (this._otlProtocol === 'grpc') {\n            otlpEndpoint = `${this._protocol}://${this._host}:${this._port}/otlp`;\n\n            const collectorOptions: OTLPMetricExporterOptions = {\n                url: otlpEndpoint,\n                headers: headerRecord,\n            };\n            metricExporter = new OTLPGrpcExporter(collectorOptions);\n        }\n\n        return { endpoint: otlpEndpoint, exporter: metricExporter };\n    }\n\n    private recordStateByIobId(id: string, state: ioBroker.State): void {\n        if (!Object.prototype.hasOwnProperty.call(this._trackedDataPoints, id)) {\n            this.log.warn(`Expected id=${id} to have a valid data point configuration, but it does not. Skipping.`);\n            return;\n        }\n\n        if (!Object.prototype.hasOwnProperty.call(this._instrumentLookup, id)) {\n            this.log.warn(`Expected id=${id} to have a valid instrument, but it does not. Skipping.`);\n            return;\n        }\n\n        const dataPointCfg = this._trackedDataPoints[id];\n        const instrument = this._instrumentLookup[id];\n        this.log.debug(`Received state change for tracked data point: ${id}. Persisting.`);\n\n        const otlpValue = this.transformStateValue(state.val);\n        this.log.debug(`Determined value to write: '${otlpValue}'.`);\n\n        if (isNullOrUndefined(otlpValue)) {\n            return;\n        }\n\n        instrument.record(otlpValue, iobTable2Record(dataPointCfg?.attributes));\n    }\n\n    private transformStateValue(iobValue: ioBroker.StateValue): number | null {\n        return parseNumberWithNull(iobValue);\n    }\n\n    private setConnected(isConnected: boolean): void {\n        if (this._connected !== isConnected) {\n            this._connected = isConnected;\n            void this.setState('info.connection', this._connected, true, error =>\n                // analyse if the state could be set (because of permissions)\n                error\n                    ? this.log.error(`Can not update this._connected state: ${error}`)\n                    : this.log.debug(`connected set to ${this._connected}`),\n            );\n        }\n    }\n}\nif (require.main !== module) {\n    // Export the constructor in compact mode\n    module.exports = (options: Partial<utils.AdapterOptions> | undefined) => new Otlp(options);\n} else {\n    // otherwise start the instance directly\n    (() => new Otlp())();\n}\n"],
  "mappings": "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",
  "names": ["OTLPHttpExporter", "OTLPGrpcExporter"]
}
