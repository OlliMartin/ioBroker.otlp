{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["/*\n * Created with @iobroker/create-adapter v3.1.2\n */\n\nimport type { Gauge, Meter as IMeter } from '@opentelemetry/api';\nimport { MeterProvider, PeriodicExportingMetricReader } from '@opentelemetry/sdk-metrics';\nimport type { OTLPMetricExporterOptions } from '@opentelemetry/exporter-metrics-otlp-http';\nimport { OTLPMetricExporter as OTLPHttpExporter } from '@opentelemetry/exporter-metrics-otlp-http';\n\nimport * as utils from '@iobroker/adapter-core';\nimport type { InfluxDBAdapterConfig, InfluxDbCustomConfig, InfluxDbCustomConfigTyped } from './types';\n\nfunction isNullOrUndefined(obj?: any): obj is null {\n    return obj === undefined || obj === null;\n}\n\nfunction parseBool(value: any, defaultValue?: boolean): boolean {\n    if (value !== undefined && value !== null && value !== '') {\n        return value === true || value === 'true' || value === 1 || value === '1';\n    }\n    return defaultValue || false;\n}\n\nfunction parseNumber(value: any, defaultValue?: number): number {\n    if (typeof value === 'number') {\n        return value;\n    }\n    if (typeof value === 'string') {\n        const v = parseFloat(value);\n        return isNaN(v) ? defaultValue || 0 : v;\n    }\n    return defaultValue || 0;\n}\n\nfunction parseNumberWithNull(value: any): number | null {\n    if (typeof value === 'number') {\n        return value;\n    }\n    if (typeof value === 'string') {\n        const v = parseFloat(value);\n        return isNaN(v) ? null : v;\n    }\n    if (typeof value === 'boolean') {\n        return value ? 1 : 0;\n    }\n    return null;\n}\n\nfunction normalizeStateConfig(\n    customConfig: InfluxDbCustomConfig,\n    defaultConfig: InfluxDBAdapterConfig,\n): InfluxDbCustomConfigTyped {\n    // debounceTime and debounce compatibility handling\n    if (!customConfig.blockTime && customConfig.blockTime !== '0' && customConfig.blockTime !== 0) {\n        if (!customConfig.debounce && customConfig.debounce !== '0' && customConfig.debounce !== 0) {\n            customConfig.blockTime = defaultConfig.blockTime || 0;\n        } else {\n            customConfig.blockTime = parseInt(customConfig.debounce as string, 10) || 0;\n        }\n    } else {\n        customConfig.blockTime = parseInt(customConfig.blockTime as string, 10) || 0;\n    }\n\n    customConfig.debounceTime = parseNumber(customConfig.debounceTime, 0);\n    customConfig.changesOnly = parseBool(customConfig.changesOnly);\n    customConfig.ignoreZero = parseBool(customConfig.ignoreZero);\n\n    // round\n    if (customConfig.round !== null && customConfig.round !== undefined && customConfig.round !== '') {\n        customConfig.round = parseInt(customConfig.round as string, 10);\n        if (!isFinite(customConfig.round) || customConfig.round < 0) {\n            customConfig.round = defaultConfig.round;\n        } else {\n            customConfig.round = Math.pow(10, parseInt(customConfig.round as unknown as string, 10));\n        }\n    } else {\n        customConfig.round = defaultConfig.round;\n    }\n\n    customConfig.ignoreAboveNumber = parseNumberWithNull(customConfig.ignoreAboveNumber);\n    customConfig.ignoreBelowNumber = parseNumberWithNull(customConfig.ignoreBelowNumber);\n    if (customConfig.ignoreBelowNumber === null && parseBool(customConfig.ignoreBelowZero)) {\n        customConfig.ignoreBelowNumber = 0;\n    }\n\n    customConfig.disableSkippedValueLogging = parseBool(\n        customConfig.disableSkippedValueLogging,\n        defaultConfig.disableSkippedValueLogging,\n    );\n    customConfig.enableDebugLogs = parseBool(customConfig.enableDebugLogs, defaultConfig.enableDebugLogs);\n    customConfig.changesRelogInterval = parseNumber(\n        customConfig.changesRelogInterval,\n        defaultConfig.changesRelogInterval as number,\n    );\n    customConfig.changesMinDelta = parseNumber(customConfig.changesMinDelta, defaultConfig.changesMinDelta);\n\n    customConfig.storageType ||= false;\n    return customConfig as InfluxDbCustomConfigTyped;\n}\n\ninterface SavedInfluxDbCustomConfig extends InfluxDbCustomConfigTyped {\n    config: string;\n    realId: string;\n    storageTypeAdjustedInternally: boolean;\n    relogTimeout: NodeJS.Timeout | null;\n    state: ioBroker.State | null | undefined;\n    skipped: ioBroker.State | null | undefined;\n    timeout: NodeJS.Timeout | null;\n    lastLogTime?: number;\n}\n\nclass Otlp extends utils.Adapter {\n    declare config: InfluxDBAdapterConfig;\n\n    // mapping from ioBroker ID to Alias ID\n    private readonly _aliasMap: { [ioBrokerId: string]: string } = {};\n    private _subscribeAll = false;\n\n    private _meterProvider: MeterProvider | null = null;\n    private _meter: IMeter | null = null;\n\n    // Mapping from AliasID to ioBroker ID\n    private readonly _influxDPs: {\n        [ioBrokerId: string]: SavedInfluxDbCustomConfig;\n    } = {};\n\n    private readonly _instrumentLookup: Record<string, Gauge> = {};\n\n    public constructor(options: Partial<utils.AdapterOptions> = {}) {\n        super({\n            ...options,\n            name: 'otlp',\n        });\n        this.on('ready', this.onReady.bind(this));\n        this.on('stateChange', this.onStateChange.bind(this));\n        this.on('objectChange', this.onObjectChange.bind(this));\n        this.on('message', this.onMessage.bind(this));\n        this.on('unload', this.onUnload.bind(this));\n    }\n\n    private async onReady(): Promise<void> {\n        // TODO: Load gRPC/http-proto config\n        // -> Create http/grpc exporter respectively\n\n        const collectorOptions: OTLPMetricExporterOptions = {\n            url: 'https://otlp.acaad.dev:4318/v1/metrics',\n        };\n\n        const metricExporter = new OTLPHttpExporter(collectorOptions);\n\n        this._meterProvider = new MeterProvider({\n            readers: [\n                new PeriodicExportingMetricReader({\n                    exporter: metricExporter,\n                    exportIntervalMillis: 1000,\n                }),\n            ],\n        });\n\n        // TODO: Allow providing meter name from adapter config.\n        this._meter = this._meterProvider.getMeter('ioBroker.otlp', undefined, {});\n\n        await this.loadCustomEntitiesAsync();\n\n        this.createMetricInstruments();\n\n        this.subscribeToStates();\n        this.subscribeForeignObjects('*');\n    }\n\n    private subscribeToStates(): void {\n        // If we have less than 20 datapoints, subscribe individually, else subscribe to all\n        if (Object.keys(this._influxDPs).length < 20) {\n            this.log.info(`subscribing to ${Object.keys(this._influxDPs).length} data points`);\n            for (const _id in this._influxDPs) {\n                if (Object.prototype.hasOwnProperty.call(this._influxDPs, _id)) {\n                    this.subscribeForeignStates(this._influxDPs[_id].realId);\n                }\n            }\n        } else {\n            this.log.debug(\n                `subscribing to all data points as we have ${Object.keys(this._influxDPs).length} data points to log`,\n            );\n            this._subscribeAll = true;\n            this.subscribeForeignStates('*');\n        }\n    }\n\n    private async loadCustomEntitiesAsync(): Promise<void> {\n        const doc = await this.getObjectViewAsync('system', 'custom', {});\n\n        if (!doc || !doc.rows || doc.rows.length == 0) {\n            return;\n        }\n\n        const filteredRows = doc.rows.filter(row => !!row.value).filter(row => row.value[this.namespace]?.enabled);\n\n        for (const row of filteredRows) {\n            const item: {\n                id: string;\n                value: {\n                    [key: `${string}.${number}`]: InfluxDbCustomConfigTyped;\n                };\n            } = row;\n\n            let id = item.id;\n            const realId = id;\n\n            if (item.value[this.namespace]?.aliasId) {\n                this._aliasMap[id] = item.value[this.namespace].aliasId;\n                this.log.debug(`Found Alias: ${id} --> ${this._aliasMap[id]}`);\n                id = this._aliasMap[id];\n            }\n\n            this._influxDPs[id] = normalizeStateConfig(\n                item.value[this.namespace],\n                this.config,\n            ) as SavedInfluxDbCustomConfig;\n\n            this._influxDPs[id].config = JSON.stringify(item.value[this.namespace]);\n            this.log.debug(`enabled logging of ${id}, Alias=${id !== realId} points now activated`);\n\n            this._influxDPs[id].realId = realId;\n            await this.writeInitialValue(realId, id);\n        }\n    }\n\n    private createMetricInstruments(): void {\n        this.log.info(`Creating instruments for ${Object.keys(this._influxDPs).length} data points.`);\n\n        for (const trackedDataPointKey of Object.keys(this._influxDPs)) {\n            this.createInstrumentForDataPointKey(trackedDataPointKey);\n        }\n    }\n\n    private getInstrumentIdentifier(dataPoint: SavedInfluxDbCustomConfig): string {\n        const { aliasId, realId } = dataPoint;\n\n        // TBD: Check if this is required.\n        return isNullOrUndefined(aliasId) || aliasId.trim() === '' ? realId : aliasId;\n    }\n\n    private createInstrumentForDataPointKey(trackedDataPointKey: string): void {\n        const trackedDataPoint = this._influxDPs[trackedDataPointKey];\n        const instrumentIdentifier = this.getInstrumentIdentifier(trackedDataPoint);\n\n        if (isNullOrUndefined(this._meter)) {\n            this.log.error('No meter instance was created. This should never happen.');\n            return;\n        }\n\n        this.log.debug(`Creating gauge with name: '${instrumentIdentifier}'`);\n        this._instrumentLookup[instrumentIdentifier] = this._meter.createGauge(instrumentIdentifier);\n    }\n\n    private removeInstrumentForDataPointKey(trackedDataPointKey: string): void {\n        const trackedDataPoint = this._influxDPs[trackedDataPointKey];\n        const instrumentIdentifier = this.getInstrumentIdentifier(trackedDataPoint);\n\n        if (!Object.prototype.hasOwnProperty.call(this._instrumentLookup, instrumentIdentifier)) {\n            this.log.warn(\n                `Expected instrument '${instrumentIdentifier}' to be present, but it was not. Skipping removal.`,\n            );\n            return;\n        }\n\n        delete this._instrumentLookup[instrumentIdentifier];\n    }\n\n    private async onUnload(callback: () => void): Promise<void> {\n        try {\n            this.log.info('Shutting down open telemetry SDK.');\n\n            if (!isNullOrUndefined(this._meterProvider)) {\n                await this._meterProvider.forceFlush();\n                await this._meterProvider.shutdown();\n            }\n        } finally {\n            callback();\n        }\n    }\n\n    private isTrackedDataPoint(object: unknown): object is InfluxDbCustomConfig {\n        if (object === null || object === undefined) {\n            return false;\n        }\n\n        return (\n            Object.prototype.hasOwnProperty.call(object, 'aliasId') &&\n            Object.prototype.hasOwnProperty.call(object, 'enabled')\n        );\n    }\n\n    private onObjectChange(id: string, obj: ioBroker.Object | null | undefined): void {\n        const formerAliasId = this._aliasMap[id] ? this._aliasMap[id] : id;\n\n        if (isNullOrUndefined(obj?.common?.custom?.[this.namespace])) {\n            return;\n        }\n\n        const customConfig = obj.common.custom[this.namespace];\n\n        if (!this.isTrackedDataPoint(customConfig)) {\n            return;\n        }\n\n        if (customConfig.enabled) {\n            this.addTrackedAlias(id, customConfig, formerAliasId);\n            this.createInstrumentForDataPointKey(id);\n        } else {\n            this.removeTrackedAlias(id, formerAliasId);\n            this.removeInstrumentForDataPointKey(id);\n        }\n    }\n\n    private addTrackedAlias(id: string, customConfig: InfluxDbCustomConfig, formerAliasId: string): void {\n        const realId = id;\n        let checkForRemove = true;\n\n        if (customConfig.aliasId) {\n            if (customConfig.aliasId !== id) {\n                this._aliasMap[id] = customConfig.aliasId;\n                this.log.debug(`Registered Alias: ${id} --> ${this._aliasMap[id]}`);\n                id = this._aliasMap[id];\n                checkForRemove = false;\n            } else {\n                this.log.warn(`Ignoring Alias-ID because identical to ID for ${id}`);\n                customConfig.aliasId = '';\n            }\n        }\n\n        if (checkForRemove && this._aliasMap[id]) {\n            this.log.debug(`Removed Alias: ${id} !-> ${this._aliasMap[id]}`);\n            delete this._aliasMap[id];\n        }\n\n        // if not yet subscribed\n        if (!this._influxDPs[formerAliasId] && !this._subscribeAll) {\n            if (Object.keys(this._influxDPs).length >= 19) {\n                // unsubscribe all subscriptions and subscribe to all\n                for (const _id in this._influxDPs) {\n                    this.unsubscribeForeignStates(this._influxDPs[_id].realId);\n                }\n                this._subscribeAll = true;\n                this.subscribeForeignStates('*');\n            } else {\n                this.subscribeForeignStates(realId);\n            }\n        }\n\n        const customSettings: InfluxDbCustomConfig = normalizeStateConfig(customConfig, this.config);\n\n        if (\n            this._influxDPs[formerAliasId] &&\n            !this._influxDPs[formerAliasId].storageTypeAdjustedInternally &&\n            JSON.stringify(customSettings) === this._influxDPs[formerAliasId].config\n        ) {\n            this.log.debug(`Object ${id} unchanged. Ignore`);\n            return;\n        }\n\n        // relogTimeout\n        if (this._influxDPs[formerAliasId] && this._influxDPs[formerAliasId].relogTimeout) {\n            clearTimeout(this._influxDPs[formerAliasId].relogTimeout);\n            this._influxDPs[formerAliasId].relogTimeout = null;\n        }\n\n        const state = this._influxDPs[formerAliasId] ? this._influxDPs[formerAliasId].state : null;\n        const skipped = this._influxDPs[formerAliasId] ? this._influxDPs[formerAliasId].skipped : null;\n        const timeout = this._influxDPs[formerAliasId] ? this._influxDPs[formerAliasId].timeout : null;\n\n        this._influxDPs[id] = customSettings as SavedInfluxDbCustomConfig;\n        this._influxDPs[id].config = JSON.stringify(customSettings);\n        this._influxDPs[id].realId = realId;\n        this._influxDPs[id].state = state;\n        this._influxDPs[id].skipped = skipped;\n        this._influxDPs[id].timeout = timeout;\n\n        void this.writeInitialValue(realId, id);\n\n        this.log.info(`enabled logging of ${id}, Alias=${id !== realId}`);\n    }\n\n    private removeTrackedAlias(id: string, formerAliasId: string): void {\n        if (this._aliasMap[id]) {\n            this.log.debug(`Removed Alias: ${id} !-> ${this._aliasMap[id]}`);\n            delete this._aliasMap[id];\n        }\n\n        id = formerAliasId;\n\n        if (!this._influxDPs[id]) {\n            return;\n        }\n\n        const relogTimeout = this._influxDPs[id].relogTimeout;\n        if (relogTimeout) {\n            clearTimeout(relogTimeout);\n        }\n        const timeout = this._influxDPs[id].timeout;\n        if (timeout) {\n            clearTimeout(timeout);\n        }\n\n        delete this._influxDPs[id];\n        this.log.info(`disabled logging of ${id}`);\n\n        if (!this._subscribeAll) {\n            this.unsubscribeForeignStates(id);\n        }\n    }\n\n    async writeInitialValue(realId: string, id: string): Promise<void> {\n        const state = await this.getForeignStateAsync(realId);\n\n        if (!state || !this._influxDPs[id]) {\n            return;\n        }\n\n        state.from = `system.adapter.${this.namespace}`;\n        this._influxDPs[id].state = state;\n\n        this.log.debug('writeInitialValue called');\n    }\n\n    private onStateChange(id: string, state: ioBroker.State | null | undefined): void {\n        if (!state) {\n            return;\n        }\n\n        if (isNullOrUndefined(this._influxDPs[id])) {\n            return;\n        }\n\n        if (!Object.prototype.hasOwnProperty.call(this._instrumentLookup, id)) {\n            this.log.warn(`Expected id=${id} to have a valid instrument, but it does not. Skipping data point.`);\n            return;\n        }\n\n        const instrument = this._instrumentLookup[id];\n        this.log.debug(`Received state change for tracked data point: ${id}. Persisting.`);\n\n        const otlpValue = this.transformStateValue(instrument, state.val);\n        this.log.debug(`Determined value to write: '${otlpValue}'.`);\n\n        if (isNullOrUndefined(otlpValue)) {\n            return;\n        }\n\n        instrument.record(otlpValue);\n\n        this._meterProvider?.forceFlush();\n    }\n\n    private transformStateValue(instrument: Gauge, iobValue: ioBroker.StateValue): number | null {\n        return parseNumberWithNull(iobValue);\n    }\n\n    private onMessage(msg: ioBroker.Message): void {\n        this.log.debug(`Incoming message ${msg.command} from ${msg.from}`);\n        this.log.info(JSON.stringify(msg));\n    }\n}\nif (require.main !== module) {\n    // Export the constructor in compact mode\n    module.exports = (options: Partial<utils.AdapterOptions> | undefined) => new Otlp(options);\n} else {\n    // otherwise start the instance directly\n    (() => new Otlp())();\n}\n"],
  "mappings": "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",
  "names": ["OTLPHttpExporter", "_a"]
}
